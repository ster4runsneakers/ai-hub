<!doctype html>
<html lang="el" data-theme="auto">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ai Hub</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" href="static/icons/icon-192.png">
  <link rel="apple-touch-icon" href="static/icons/icon-512.png">
  <meta id="theme-color" name="theme-color" content="#0b0b10">

  <!-- iOS PWA polish -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="static/icons/icon-512.png">
  <meta name="apple-mobile-web-app-title" content="Ai Hub">

  <!-- SEO basics -->
  <meta name="description" content="Ai Hub ‚Ä¢ Projects ‚Äî ŒºŒπŒ∫œÅœå hub ŒºŒµ ŒµœÅŒ≥Œ±ŒªŒµŒØŒ± (Ai Studio, Sneakers Tools, Creator Packs). Light/Dark/Auto, PWA, offline cache.">
  <link rel="canonical" href="./">

  <!-- Open Graph / Social -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Ai Hub ‚Ä¢ Projects">
  <meta property="og:description" content="ŒïœÅŒ≥Œ±ŒªŒµŒØŒ± Œ≥ŒπŒ± content & e-commerce. ŒïŒªŒ±œÜœÅœç, Œ≥œÅŒÆŒ≥ŒøœÅŒø, PWA.">
  <meta property="og:image" content="static/icons/icon-512.png">
  <meta property="og:url" content="./">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Ai Hub ‚Ä¢ Projects">
  <meta name="twitter:description" content="ŒïœÅŒ≥Œ±ŒªŒµŒØŒ± Œ≥ŒπŒ± content & e-commerce. ŒïŒªŒ±œÜœÅœç, Œ≥œÅŒÆŒ≥ŒøœÅŒø, PWA.">
  <meta name="twitter:image" content="static/icons/icon-192.png">

  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="wrap">
    <header>
      <a class="brand" href="#">
        <span class="logo">AI</span>
        <span><strong>Ai Hub</strong> ‚Ä¢ Projects</span>
      </a>
      <div class="tools" role="group" aria-label="Theme">
        <button class="btn" data-theme-btn="light" aria-pressed="false">Light</button>
        <button class="btn" data-theme-btn="dark"  aria-pressed="false">Dark</button>
        <button class="btn" data-theme-btn="auto"  aria-pressed="false">Auto</button>
        <span id="theme-hint" class="hint"></span>
        <button id="btn-install" class="btn" style="margin-left:auto;display:none;">Install</button>
      </div>
    </header>

    <div class="search">
      <input id="q" placeholder="üîé ŒëŒΩŒ±Œ∂ŒÆœÑŒ∑œÉŒ∑ (œÄ.œá. ai studio, captions, sneakers)">
      <select id="tag">
        <option value="">ŒåŒªŒ± œÑŒ± tags</option>
      </select>
    </div>

    <section id="grid" class="grid" aria-live="polite"></section>

    <footer>
      <div>¬© 2025 Ai Hub</div>
      <div>Installable PWA ‚Ä¢ Mobile friendly</div>
    </footer>
  </div>

  <script>
    // ===== THEME =====
    const root=document.documentElement;
    const metaTheme=document.getElementById('theme-color');
    const hintEl=document.getElementById('theme-hint');
    const mqDark = window.matchMedia('(prefers-color-scheme: dark)');

    const systemPref = ()=> mqDark.matches ? 'dark' : 'light';
    const effectiveTheme = (mode)=> mode==='auto' ? systemPref() : mode;
    const updateMetaTheme = (mode)=> {
      const eff = effectiveTheme(mode);
      metaTheme.setAttribute('content', eff==='dark' ? '#0b0b10' : '#fbfbfe');
    };

    function applyTheme(mode){
      root.setAttribute('data-theme', mode);
      updateMetaTheme(mode);
      const eff = effectiveTheme(mode);
      hintEl.textContent = mode==='auto' ? `Auto ‚Ä¢ system: ${eff}` : `Theme: ${mode}`;
      document.querySelectorAll('.tools .btn[data-theme-btn]').forEach(b=>{
        b.setAttribute('aria-pressed', String(b.dataset.themeBtn===mode));
      });
    }
    function setTheme(mode){ localStorage.setItem('hub_theme',mode); applyTheme(mode); }

    const saved = localStorage.getItem('hub_theme') || 'auto';
    applyTheme(saved);

    document.querySelectorAll('.tools .btn[data-theme-btn]').forEach(b=>{
      b.addEventListener('click', ()=> setTheme(b.dataset.themeBtn));
    });
    const onSystemChange = ()=> {
      if ((localStorage.getItem('hub_theme')||'auto')==='auto') applyTheme('auto');
    };
    if (mqDark.addEventListener) mqDark.addEventListener('change', onSystemChange);
    else if (mqDark.addListener) mqDark.addListener(onSystemChange);

    // ===== APPS =====
    const state={apps:[], q:'', tag:''};
    const grid=document.getElementById('grid');
    const selTag=document.getElementById('tag');
    const inputQ=document.getElementById('q');

    fetch('apps.json?_='+Date.now())
      .then(r=>r.json())
      .then(d=>{
        state.apps=d.apps||[];
        const tags=new Set(); state.apps.forEach(a=> (a.tags||[]).forEach(t=> tags.add(t)));
        [...tags].sort().forEach(t=>{
          const opt=document.createElement('option'); opt.value=t; opt.textContent=t; selTag.appendChild(opt);
        });
        render();
      })
      .catch(()=>{ grid.innerHTML='<div class="desc">ŒîŒµŒΩ Œ≤œÅŒ≠Œ∏Œ∑Œ∫Œ±ŒΩ apps.</div>'; });

    const esc = (s)=> (s||'').replace(/[&<>"]/g,c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;' }[c]));
    function card(a){
      const icon = a.icon ? `<img src="${esc(a.icon)}" alt="" width="24" height="24" style="border-radius:6px;border:1px solid var(--ring)">` : 'üöÄ';
      const tags = (a.tags||[]).map(t=>`<span class="badge">${esc(t)}</span>`).join('');

      const openBtn = a.url  ? `<a class="btn primary" href="${esc(a.url)}" target="_blank" rel="noopener">Open App</a>` : '';
      const repoBtn = a.repo ? `<a class="btn" href="${esc(a.repo)}" target="_blank" rel="noopener">Repo</a>` : '';
      const actions = (openBtn || repoBtn)
        ? `<div class="actions">${openBtn}${repoBtn}</div>`
        : `<div class="actions"><span class="hint">üöß Coming soon</span></div>`;

      return `
        <article class="card">
          <div style="display:flex;gap:10px;align-items:center">
            <div>${icon}</div><div class="title">${esc(a.name)}</div>
          </div>
          <div class="desc">${esc(a.desc||'')}</div>
          <div class="badges">${tags}</div>
          ${actions}
        </article>`;
    }
    function render(){
      const q=(state.q||'').toLowerCase(), tag=state.tag||'';
      const list=state.apps.filter(a=>{
        const matchesQ = !q || [a.name,a.desc,(a.repo||''),(a.url||''),(a.tags||[]).join(' ')].join(' ').toLowerCase().includes(q);
        const matchesTag=!tag || (a.tags||[]).includes(tag);
        return matchesQ && matchesTag;
      });
      grid.innerHTML = list.map(a=>card(a)).join('') || '<div class="desc">ŒîŒµŒΩ Œ≤œÅŒ≠Œ∏Œ∑Œ∫Œ±ŒΩ apps.</div>';
    }
    inputQ.addEventListener('input',e=>{ state.q=e.target.value; render(); });
    selTag.addEventListener('change',e=>{ state.tag=e.target.value; render(); });

    // ===== PWA INSTALL BUTTON =====
    let deferredPrompt=null;
    const installBtn=document.getElementById('btn-install');

    window.addEventListener('beforeinstallprompt', (e)=>{
      e.preventDefault();
      deferredPrompt=e;
      installBtn.style.display='inline-block';
    });

    installBtn.addEventListener('click', async ()=>{
      if(!deferredPrompt) return;
      deferredPrompt.prompt();
      await deferredPrompt.userChoice;
      deferredPrompt=null;
      installBtn.style.display='none';
    });

    if('serviceWorker' in navigator){
      navigator.serviceWorker.register('service-worker.js').catch(console.warn);
    }
  </script>
</body>
</html>

